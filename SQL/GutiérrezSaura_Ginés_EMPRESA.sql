# se comprueba si existe la bd, y se borra en ese caso
DROP DATABASE IF EXISTS EMPRESA;

CREATE DATABASE EMPRESA;

CREATE TABLE CENTROS (
	Numero INT PRIMARY KEY,
	Nombre VARCHAR(25) NOT NULL,
	Direccion VARCHAR(30) NOT NULL
);

SHOW CREATE TABLE CENTROS;
DESCRIBE CENTROS;

CREATE TABLE DEPARTAMENTOS (
	Numero INT PRIMARY KEY,
	Centro INT NOT NULL,
	Director INT NOT NULL,
	Tipo_dir ENUM('P','F') NOT NULL,
	Presupuesto DECIMAL(6,2) NOT NULL,
	Dpto_jefe INT NULL,
	Nombre VARCHAR(25) NOT NULL,
	CONSTRAINT fk_Centro FOREIGN KEY (Centro) REFERENCES CENTROS(Numero)
);

SHOW CREATE TABLE DEPARTAMENTOS;
DESCRIBE DEPARTAMENTOS;

CREATE TABLE EMPLEADOS (
	Cod INT PRIMARY KEY,
	Departamento INT NOT NULL,
	Telefono VARCHAR(11) NOT NULL,
	Fecha_nacimiento DATE NOT NULL,
	Fecha_ingreso DATE NOT NULL,
	Salario DECIMAL(6,2) NOT NULL,
	Comision DECIMAL(5,2) NOT NULL,
	Num_hijos INT NOT NULL,
	NOmbre VARCHAR(25),
	CONSTRAINT fk_Departamento FOREIGN KEY (Departamento) REFERENCES DEPARTAMENTOS(Numero)
);

SHOW CREATE TABLE EMPLEADOS;
DESCRIBE EMPLEADOS;

ALTER TABLE DEPARTAMENTOS ADD CONSTRAINT fk_Dpto_jefe FOREIGN KEY (Dpto_jefe) REFERENCES DEPARTAMENTOS(Numero);
ALTER TABLE DEPARTAMENTOS ADD CONSTRAINT fk_Director FOREIGN KEY (Director) REFERENCES EMPLEADOS(Cod);

SHOW CREATE TABLE DEPARTAMENTOS;
DESCRIBE DEPARTAMENTOS;

INSERT INTO CENTROS VALUES
(10, 'SEDE CENTRAL', 'C/ ALCALA 820, MADRID'),
(20, 'RELACION CON CLIENTES', 'C/ ATOCHA 405, MADRID');
	
INSERT INTO DEPARTAMENTOS VALUES
(100, 10, 260, 'P', 12, null ,'DIRECCION GENERAL');

INSERT INTO EMPLEADOS VALUES
(110, 121, 350, '1969-11-100', '1990-02-10', 1310, null, 3 ,'PONS, CESAR');

# HAY QUE QUITAR LA CLAVE FORAREA fk_Departamento en EMPLEADOS para a√±adir los registros (luego ponerla otra vez)

INSERT INTO CENTROS VALUES
(10, 'SEDE CENTRAL', 'C/ ALCALA 820, MADRID'),
(20, 'RELACION CON CLIENTES', 'C/ ATOCHA 405, MADRID');
	
	
INSERT INTO DEPARTAMENTOS VALUES
(100, 10, 260, 'P', 12, null ,'DIRECCION GENERAL');
(110, 20, 180, 'P', 15, 100, 'DIRECC. COMERCIAL'),
(111, 20, 180, 'F', 11, 110, 'SECTOR INDUSTRIAL'),
(112, 20, 270, 'P', 9, 100, 'SECTOR SERVICIOS'),
(120, 10, 150, 'F', 3, 100, 'ORGANIZACION'),
(121, 10, 150, 'P', 2, 120, 'PERSONAL'),
(122, 10, 350, 'P', 6, 120, 'PROCESO DE DATOS'),
(130, 10, 310, 'P', 2, 100, 'FINANZAS');




INSERT INTO EMPLEADOS VALUES
( 110, 121, 350, '1969-11-10', '1990-02-10', 1310, null, 3, "PONS, CESAR");
(120, 112, 840, '1975-06-09', '1998-10-01', 1350, 110, 1, 'LASA, MARIO'),
(130, 112, 810, '1985-11-09', '2009-02-01', 1290, 110, 2, 'TEROL, LUCIANO'),
(150, 121, 340, '1970-08-10', '1997-01-15', 1440, null, 0, 'PEREZ, JULIO'),
(160, 111, 740, '1979-07-09', '2005-11-11', 1310, 110, 2, 'AGUIRRE, AUREO'),
(180, 110, 508, '1974-10-18', '1998-03-18', 1480, 50, 2, 'PEREZ, MARCOS'),
(190, 121, 350, '1972-05-12', '2002-02-11', 1300, null, 4, 'VEIGA, JULIANA'),
(210, 100, 200, '1980-09-28', '2010-01-22', 1380, null, 2, 'GALVEZ, PILAR'),
(240, 111, 760, '1982-02-26', '2006-02-24', 1280, 100, 3, 'SANZ, LAVINIA'),
(250, 100, 250, '1986-10-27', '2007-03-01', 990, null, 0, 'ALBA, ADRIANA'),
(260, 100, 220, '1983-12-03', '2008-07-12', 1720, null, 6, 'LOPEZ, ANTONIO'),
(270, 112, 800, '1985-05-21', '2009-09-10', 950, 80, 3, 'ARCIA, OCTAVIO'),
(280, 30, 410, '1988-01-11', '2020-10-08', 1100, null, 5, 'FLOR, DOROTEA'),
(285, 122, 620, '1989-10-25', '2018-02-15', 1380, null, 0, 'POLO, OTILIA'),
(290, 120, 910, '1987-11-30', '2012-02-14', 1270, null, 3, 'GIL, GLORIA'),
(310, 130, 480, '1991-11-21', '2019-01-05', 1420, null, 0, 'GARCIA, AUGUSTO'),
(320, 122, 620, '1997-12-25', '2018-02-05', 1405, null, 2, 'SANZ, CORNELIO');
(330, 112, 850, "1988-08-19", "2010-03-01", 1280, 90, 0, "DIEZ, AMELIA"),
(350, 122, 610, "1989-04-13", "2014-09-10", 1450, null, 1, "CAMPS, AURELIO"),
(360, 111, 750, "1988-10-29", "2015-10-10", 1250, 100, 2, "LARA, DORINDA");